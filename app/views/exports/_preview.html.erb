<div class="space-y-6">
  <% if @preview_data[:error] %>
    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
      <div class="flex">
        <svg class="w-5 h-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
        </svg>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-red-800">Preview Error</h3>
          <p class="mt-1 text-sm text-red-700"><%= @preview_data[:error] %></p>
        </div>
      </div>
    </div>
  <% else %>
    <!-- Format Overview -->
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
      <div class="flex items-start">
        <svg class="w-5 h-5 text-blue-600 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
        </svg>
        <div class="ml-3 flex-1">
          <h3 class="text-sm font-medium text-blue-900">
            Export Format: <%= @preview_data[:format]&.upcase %>
          </h3>
          
          <% case @preview_data[:format] %>
          <% when 'pdf' %>
            <div class="mt-2 text-sm text-blue-700">
              <p><strong>Layout:</strong> <%= @preview_data[:layout]&.humanize %></p>
              <p><strong>Estimated Pages:</strong> <%= @preview_data[:estimated_pages] %></p>
            </div>
            
            <% if @preview_data[:sections] %>
              <div class="mt-3">
                <h4 class="font-medium text-blue-800">Sections to Include:</h4>
                <ul class="mt-1 space-y-1">
                  <% @preview_data[:sections].each do |section| %>
                    <li class="text-sm text-blue-700">
                      <span class="font-medium"><%= section[:name] %>:</span> <%= section[:description] %>
                    </li>
                  <% end %>
                </ul>
              </div>
            <% end %>
            
          <% when 'excel' %>
            <div class="mt-2 text-sm text-blue-700">
              <p><strong>Estimated Rows:</strong> <%= @preview_data[:estimated_rows] %></p>
            </div>
            
            <% if @preview_data[:worksheets] %>
              <div class="mt-3">
                <h4 class="font-medium text-blue-800">Worksheets:</h4>
                <ul class="mt-1 space-y-1">
                  <% @preview_data[:worksheets].each do |worksheet| %>
                    <li class="text-sm text-blue-700">
                      <span class="font-medium"><%= worksheet[:name] %>:</span> <%= worksheet[:description] %>
                    </li>
                  <% end %>
                </ul>
              </div>
            <% end %>
            
          <% when 'csv' %>
            <div class="mt-2 text-sm text-blue-700">
              <p><strong>CSV Format:</strong> <%= @preview_data[:csv_format]&.humanize %></p>
              <p><strong>Description:</strong> <%= @preview_data[:description] %></p>
              <p><strong>Estimated Rows:</strong> <%= @preview_data[:estimated_rows] %></p>
            </div>
            
            <% if @preview_data[:columns] %>
              <div class="mt-3">
                <h4 class="font-medium text-blue-800">Columns:</h4>
                <div class="mt-1 flex flex-wrap gap-1">
                  <% @preview_data[:columns].each do |column| %>
                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
                      <%= column %>
                    </span>
                  <% end %>
                </div>
              </div>
            <% end %>
            
          <% when 'name_tags' %>
            <div class="mt-2 text-sm text-blue-700">
              <p><strong>Tag Format:</strong> <%= @preview_data[:tag_format]&.humanize %></p>
              <p><strong>Style:</strong> <%= @preview_data[:style]&.humanize %></p>
              <p><strong>Tags per Page:</strong> <%= @preview_data[:tags_per_page] %></p>
              <p><strong>Estimated Pages:</strong> <%= @preview_data[:estimated_pages] %></p>
            </div>
            
          <% when 'powerpoint' %>
            <div class="mt-2 text-sm text-blue-700">
              <p><strong>Style:</strong> <%= @preview_data[:style]&.humanize %></p>
              <p><strong>Estimated Slides:</strong> <%= @preview_data[:estimated_slides] %></p>
              <p><strong>Output Format:</strong> <%= @preview_data[:output_format] %></p>
            </div>
            
            <% if @preview_data[:slides] %>
              <div class="mt-3">
                <h4 class="font-medium text-blue-800">Slides:</h4>
                <ul class="mt-1 space-y-1">
                  <% @preview_data[:slides].each do |slide| %>
                    <li class="text-sm text-blue-700">
                      <span class="font-medium"><%= slide[:title] %>:</span> <%= slide[:content] %>
                    </li>
                  <% end %>
                </ul>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
    
    <!-- Content Summary -->
    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
      <h4 class="font-medium text-gray-900">Content Summary</h4>
      <div class="mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
        <div class="text-center">
          <div class="font-semibold text-lg text-blue-600"><%= @seating_arrangement.students_count %></div>
          <div class="text-gray-600">Students</div>
        </div>
        <div class="text-center">
          <div class="font-semibold text-lg text-blue-600"><%= @seating_arrangement.tables_count %></div>
          <div class="text-gray-600">Tables</div>
        </div>
        <div class="text-center">
          <div class="font-semibold text-lg text-green-600"><%= @seating_arrangement.formatted_score %></div>
          <div class="text-gray-600">Score</div>
        </div>
        <div class="text-center">
          <div class="font-semibold text-lg text-purple-600">
            <%= @seating_arrangement.has_explanations? ? "✓" : "—" %>
          </div>
          <div class="text-gray-600">Explanations</div>
        </div>
      </div>
    </div>
    
    <!-- Options Applied -->
    <div class="bg-white border border-gray-200 rounded-lg p-4">
      <h4 class="font-medium text-gray-900">Export Options</h4>
      <div class="mt-3 space-y-2">
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Include Explanations:</span>
          <span class="<%= @export_options[:include_explanations] ? 'text-green-600' : 'text-gray-400' %>">
            <%= @export_options[:include_explanations] ? 'Yes' : 'No' %>
          </span>
        </div>
        
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Include Diversity Report:</span>
          <span class="<%= @export_options[:include_diversity_report] ? 'text-green-600' : 'text-gray-400' %>">
            <%= @export_options[:include_diversity_report] ? 'Yes' : 'No' %>
          </span>
        </div>
        
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Include Photos:</span>
          <span class="<%= @export_options[:include_photos] ? 'text-green-600' : 'text-gray-400' %>">
            <%= @export_options[:include_photos] ? 'Yes' : 'No' %>
          </span>
        </div>
        
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Include QR Code:</span>
          <span class="<%= @export_options[:include_qr_code] ? 'text-green-600' : 'text-gray-400' %>">
            <%= @export_options[:include_qr_code] ? 'Yes' : 'No' %>
          </span>
        </div>
        
        <% if @export_options[:layout] %>
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600">Layout:</span>
            <span class="text-gray-900"><%= @export_options[:layout]&.humanize %></span>
          </div>
        <% end %>
        
        <% if @export_options[:paper_size] %>
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600">Paper Size:</span>
            <span class="text-gray-900"><%= @export_options[:paper_size] %></span>
          </div>
        <% end %>
      </div>
    </div>
    
    <!-- Branding Preview -->
    <% if @branding_options.present? %>
      <div class="bg-white border border-gray-200 rounded-lg p-4">
        <h4 class="font-medium text-gray-900">Branding Preview</h4>
        <div class="mt-3 p-4 border rounded" style="border-color: <%= @branding_options[:primary_color] || '#1f2937' %>;">
          <div class="text-center">
            <div class="text-lg font-bold" style="color: <%= @branding_options[:primary_color] || '#1f2937' %>;">
              <%= @branding_options[:organization_name] || 'CHDS Seating Charter' %>
            </div>
            <div class="text-md font-medium mt-1" style="color: <%= @branding_options[:secondary_color] || '#3b82f6' %>;">
              <%= @branding_options[:header_text] || @seating_event.name %>
            </div>
            <% if @seating_arrangement.multi_day? %>
              <div class="text-sm text-gray-600 mt-1">
                <%= @seating_arrangement.day_name %>
              </div>
            <% end %>
          </div>
          
          <!-- Sample table representation -->
          <div class="mt-4 grid grid-cols-3 gap-2 text-xs">
            <% @seating_arrangement.tables_data.first(3).each do |table_number, table_info| %>
              <div class="border rounded p-2 text-center" style="border-color: <%= @branding_options[:secondary_color] || '#3b82f6' %>;">
                <div class="font-medium" style="color: <%= @branding_options[:secondary_color] || '#3b82f6' %>;">
                  Table <%= table_number %>
                </div>
                <div class="mt-1 text-gray-600 text-xs">
                  <%= table_info[:students].first(2).map(&:name).join(", ") %>
                  <% if table_info[:students].count > 2 %>
                    <br>+ <%= table_info[:students].count - 2 %> more
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
          
          <div class="text-center text-xs text-gray-500 mt-3">
            <%= @branding_options[:footer_text] || "Generated on #{Date.current.strftime('%B %d, %Y')}" %>
          </div>
        </div>
      </div>
    <% end %>
    
    <!-- Ready to Export -->
    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
      <div class="flex">
        <svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
        </svg>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-green-800">Ready to Export</h3>
          <p class="mt-1 text-sm text-green-700">
            Your export configuration looks good. Click "Generate Export" to create and download your file.
          </p>
        </div>
      </div>
    </div>
  <% end %>
</div>